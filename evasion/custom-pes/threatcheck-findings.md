# Using ThreatCheck on msfvenom payloads

### basic-shell.exe

msfvenom windows/shell_reverse_tcp exe

Fails to split correctly, get an unhandled exception

[+] Target file size: 7168 bytes
[+] Analyzing...
[!] Identified end of bad bytes at offset 0xCA

Unhandled Exception: System.ArgumentException: Offset and length were out of bounds for the array or count is greater than the number of elements from index to the end of the source collection.
   at System.Buffer.BlockCopy(Array src, Int32 srcOffset, Array dst, Int32 dstOffset, Int32 count)
   at ThreatCheck.Scanner.HalfSplitter(Byte[] originalarray, Int32 lastgood) in C:\Users\dev\code\ThreatCheck-master\ThreatCheck\ThreatCheck\Core\Scanner.cs:line 25
   at ThreatCheck.Defender.AnalyzeFile() in C:\Users\dev\code\ThreatCheck-master\ThreatCheck\ThreatCheck\Defender\Defender.cs:line 63
   at ThreatCheck.Program.RunOptions(Options opts) in C:\Users\dev\code\ThreatCheck-master\ThreatCheck\ThreatCheck\Program.cs:line 85
   at CommandLine.ParserResultExtensions.WithParsed[T](ParserResult`1 result, Action`1 action)
   at ThreatCheck.Program.Main(String[] args) in C:\Users\dev\code\ThreatCheck-master\ThreatCheck\ThreatCheck\Program.cs:line 33

### inject-remote-proc.exe

windows/x64/shell_reverse_tcp injected into remote process declared in args

[+] Target file size: 116940 bytes
[+] Analyzing...
[!] Identified end of bad bytes at offset 0x39E2
00000000   00 00 CD 03 66 77 72 69  74 65 00 00 FD 03 6D 61   ··I·fwrite··y·ma
00000010   6C 6C 6F 63 00 00 05 04  6D 65 6D 63 70 79 00 00   lloc····memcpy··
00000020   25 04 73 69 67 6E 61 6C  00 00 3C 04 73 74 72 6C   %·signal··<·strl
00000030   65 6E 00 00 3F 04 73 74  72 6E 63 6D 70 00 60 04   en··?·strncmp·`·
00000040   76 66 70 72 69 6E 74 66  00 00 00 80 00 00 00 80   vfprintf···?···?
00000050   00 00 00 80 00 00 00 80  00 00 00 80 00 00 00 80   ···?···?···?···?
00000060   00 00 00 80 00 00 00 80  00 00 00 80 00 00 00 80   ···?···?···?···?
00000070   00 00 00 80 00 00 00 80  00 00 00 80 00 00 00 80   ···?···?···?···?
00000080   00 00 00 80 00 00 4B 45  52 4E 45 4C 33 32 2E 64   ···?··KERNEL32.d
00000090   6C 6C 00 00 00 00 14 80  00 00 14 80 00 00 14 80   ll·····?···?···?
000000A0   00 00 14 80 00 00 14 80  00 00 14 80 00 00 14 80   ···?···?···?···?
000000B0   00 00 14 80 00 00 14 80  00 00 14 80 00 00 14 80   ···?···?···?···?
000000C0   00 00 14 80 00 00 14 80  00 00 14 80 00 00 14 80   ···?···?···?···?
000000D0   00 00 14 80 00 00 14 80  00 00 14 80 00 00 14 80   ···?···?···?···?
000000E0   00 00 14 80 00 00 14 80  00 00 14 80 00 00 14 80   ···?···?···?···?
000000F0   00 00 14 80 00 00 14 80  00 00 6D 73 76 63 72 74   ···?···?··msvcrt

### inject-local-proc.exe

windows/x64/shell_reverse_tcp injected into local process

[+] Target file size: 115454 bytes
[+] Analyzing...
[!] Identified end of bad bytes at offset 0x2027
00000000   00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00   ················
00000010   00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00   ················
00000020   00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00   ················
00000030   00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00   ················
00000040   00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00   ················
00000050   00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00   ················
00000060   00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00   ················
00000070   00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00   ················
00000080   00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00   ················
00000090   00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00   ················
000000A0   00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00   ················
000000B0   00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00   ················
000000C0   00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00   ················
000000D0   00 00 00 00 00 00 00 00  00 48 31 C9 48 81 E9 C6   ·········H1ÉH?éÆ
000000E0   FF FF FF 48 8D 05 EF FF  FF FF 48 BB 12 C1 1B 2B   ÿÿÿH?·ïÿÿÿH»·A·+
000000F0   24 8A B3 A3 48 31 58 27  48 2D F8 FF FF FF E2 F4   $?3£H1X'H-oÿÿÿâô